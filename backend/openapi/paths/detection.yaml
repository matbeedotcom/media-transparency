# Detection API paths
# Auto-generated by export_openapi.py

/detection/temporal-coordination:
  post:
    tags:
    - Detection
    summary: Analyze Temporal Coordination
    description: "Analyze temporal coordination between entities.\n\nDetects patterns indicating coordinated timing:\n- Publication\
      \ bursts\n- Lead-lag relationships\n- Synchronized timing distributions\n\nArgs:\n    request: Analysis parameters\n\
      \    background_tasks: FastAPI background tasks\n\nReturns:\n    Analysis results or job ID for async mode"
    operationId: analyze_temporal_coordination_detection_temporal_coordination_post
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TemporalAnalysisRequest'
      required: true
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              anyOf:
              - $ref: '#/components/schemas/TemporalAnalysisResponse'
              - additionalProperties: true
                type: object
              title: Response Analyze Temporal Coordination Api V1 Detection Temporal Coordination Post
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
    security:
    - HTTPBearer: []
/detection/funding-clusters:
  post:
    tags:
    - Detection
    summary: Detect Funding Clusters
    description: 'Detect funding clusters among entities.


      Identifies groups of entities sharing common funders.

      Returns clusters scored by funding concentration with evidence references.'
    operationId: detect_funding_clusters_detection_funding_clusters_post
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/FundingClusterRequest'
      required: true
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FundingClusterResponse'
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
    security:
    - HTTPBearer: []
/detection/politically-active-funded:
  post:
    tags:
    - Detection
    summary: Detect Politically Active Funded
    description: 'Find entities that receive funding AND are politically active.


      Identifies organizations that:

      1. Receive funding (via FUNDED_BY relationships)

      2. AND sponsor political ads (via SPONSORED_BY) OR lobby


      This helps detect potential influence campaigns where funding flows

      to entities that then engage in political activity.'
    operationId: detect_politically_active_funded_detection_politically_active_funded_post
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PoliticallyActiveFundedRequest'
      required: true
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PoliticallyActiveFundedResponse'
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
    security:
    - HTTPBearer: []
/detection/infrastructure-sharing:
  post:
    tags:
    - Detection
    summary: Detect Infrastructure Sharing
    description: 'Detect shared infrastructure between domains.


      Scans domain infrastructure (DNS, WHOIS, hosting, analytics, SSL)

      and identifies pairwise matches. Accepts entity IDs (resolves to domains)

      or domain strings directly.'
    operationId: detect_infrastructure_sharing_detection_infrastructure_sharing_post
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InfrastructureSharingRequest'
      required: true
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InfrastructureSharingResponse'
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
    security:
    - HTTPBearer: []
/detection/composite-score:
  post:
    tags:
    - Detection
    summary: Calculate Composite Score Endpoint
    description: "Calculate composite coordination score combining all signals.\n\nUses CompositeScoreCalculator with correlation-aware\
      \ weighting.\nRequires at least 2 independent signals from 2 different categories\nto flag potential coordination (no\
      \ single signal triggers alone).\n\nArgs:\n    request: Score calculation parameters\n\nReturns:\n    Composite score\
      \ with breakdown by signal type"
    operationId: calculate_composite_score_endpoint_detection_composite_score_post
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CompositeScoreRequest'
      required: true
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompositeScoreResponse'
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
    security:
    - HTTPBearer: []
/detection/explain/{finding_id}:
  get:
    tags:
    - Detection
    summary: Explain Finding
    description: "Get detailed explanation for a detection finding.\n\nProvides:\n- Why the finding was flagged\n- Evidence\
      \ breakdown with source links\n- Hard negatives that were checked\n- Recommendations for further investigation\n\nArgs:\n\
      \    finding_id: ID of the finding to explain\n\nReturns:\n    Detailed finding explanation"
    operationId: explain_finding_detection_explain__finding_id__get
    security:
    - HTTPBearer: []
    parameters:
    - name: finding_id
      in: path
      required: true
      schema:
        type: string
        format: uuid
        title: Finding Id
    responses:
      '200':
        description: Successful Response
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FindingExplanation'
      '422':
        description: Validation Error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HTTPValidationError'
