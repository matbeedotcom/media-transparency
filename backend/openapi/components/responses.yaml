# Common API responses
# Reusable response definitions for error handling

BadRequest:
  description: Bad Request - Invalid parameters or request body
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      examples:
        validation_error:
          summary: Validation error
          value:
            success: false
            error: "Validation failed"
            error_code: "VALIDATION_ERROR"
            details:
              - code: "INVALID_FORMAT"
                message: "Invalid UUID format"
                field: "entity_id"
        missing_parameter:
          summary: Missing required parameter
          value:
            success: false
            error: "Missing required parameter: entity_ids"
            error_code: "VALIDATION_ERROR"

Unauthorized:
  description: Unauthorized - Missing or invalid authentication token
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "Authentication required"
        error_code: "AUTHENTICATION_REQUIRED"
  headers:
    WWW-Authenticate:
      schema:
        type: string
      description: Authentication scheme

Forbidden:
  description: Forbidden - Insufficient permissions for this operation
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "Access denied. Insufficient permissions."
        error_code: "ACCESS_DENIED"

NotFound:
  description: Not Found - The requested resource does not exist
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      examples:
        entity_not_found:
          summary: Entity not found
          value:
            success: false
            error: "Entity not found: 550e8400-e29b-41d4-a716-446655440000"
            error_code: "NOT_FOUND"
        resource_not_found:
          summary: Generic resource not found
          value:
            success: false
            error: "Resource not found"
            error_code: "NOT_FOUND"

Conflict:
  description: Conflict - The request conflicts with the current state
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      examples:
        already_exists:
          summary: Resource already exists
          value:
            success: false
            error: "Entity with this identifier already exists"
            error_code: "CONFLICT"
        invalid_state:
          summary: Invalid state transition
          value:
            success: false
            error: "Cannot start a job that is already running"
            error_code: "INVALID_STATE"

UnprocessableEntity:
  description: Unprocessable Entity - Request is well-formed but contains semantic errors
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "Cannot process request: entity_ids must contain at least 2 entities"
        error_code: "UNPROCESSABLE_ENTITY"

RateLimited:
  description: Too Many Requests - Rate limit exceeded
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "Rate limit exceeded. Retry after 60 seconds."
        error_code: "RATE_LIMIT_EXCEEDED"
  headers:
    X-RateLimit-Limit:
      schema:
        type: integer
      description: Maximum requests allowed per window
    X-RateLimit-Remaining:
      schema:
        type: integer
      description: Requests remaining in current window
    X-RateLimit-Reset:
      schema:
        type: integer
      description: Seconds until rate limit resets
    Retry-After:
      schema:
        type: integer
      description: Seconds to wait before retrying

InternalError:
  description: Internal Server Error - An unexpected error occurred
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "An unexpected error occurred. Please try again later."
        error_code: "INTERNAL_ERROR"

ServiceUnavailable:
  description: Service Unavailable - The service is temporarily unavailable
  content:
    application/json:
      schema:
        $ref: './schemas/common.yaml#/ErrorResponse'
      example:
        success: false
        error: "Service temporarily unavailable. Please try again later."
        error_code: "SERVICE_UNAVAILABLE"
  headers:
    Retry-After:
      schema:
        type: integer
      description: Seconds to wait before retrying

# Success responses
NoContent:
  description: No Content - Request succeeded with no response body

Accepted:
  description: Accepted - Request accepted for async processing
  content:
    application/json:
      schema:
        type: object
        required:
          - job_id
          - status_url
        properties:
          job_id:
            type: string
            format: uuid
            description: Job ID for tracking progress
          status_url:
            type: string
            description: URL to check job status
          estimated_completion:
            type: string
            format: date-time
            description: Estimated completion time
